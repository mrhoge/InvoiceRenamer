# InvoiceRenamer

PDFファイルのプレビュー、OCR分析、ファイル名変更を行うGUIアプリケーション。

## 使い方

### 基本
1. 起動したら、「PDFフォルダを選択」を押下し、領収書が保管されている場所を指定してください
2. 取得されたPDFの一覧から、リネームしたいファイルをダブルクリックするとプレビューが表示されます。
3. プレビュー画面を左クリックで範囲指定すると、該当箇所の文字を分析して左下の一覧に追加します。
4. 左下の一覧に追加された項目をダブルクリックすると、変更後の新しいファイル名にその値が追加されます。
 * ファイル名へ追加する文字列は、「_」で区切られて追加されていきます。
5. 日付もYYYY-MM-DD（2025-05-01）のような形でファイル名に追加されます。
 * 和暦にも対応していますが、画像分析ライブラリの精度により、適切に日付と解釈されない場合があります。
 * 取得した日付を変換したくない場合は、「日付を整形して適用」のチェックを外してください。
6. 勘定科目をプルダウンから選択して「追加」を押下すると、勘定科目もファイル名に追記できます。
7. 新しいファイル名の値は、手動でも変更可能です。
8. デバッグモードとOCR情報は、基本的に無視してOKです。
9. ファイル名変更後のファイルは、選択したPDFフォルダ内にrenamedフォルダを作成し、その中にコピーされています。
 * 変更前の元ファイルは削除しませんので、確認後、任意で削除してください。
10. 勘定科目は`accnounts.csv`に行を追加することで選択肢を追加できます。

### プレビュー画面
* **左クリック + ドラッグ**: 解析範囲を指定します。
* **右クリック + ドラッグ**: 拡大したPDFをパニング（つかんで移動）します。
* **マウスホイール**: 上下へスクロールします。
* **Ctrl + マウスホイール**: 画面を拡大・縮小します。

## システム要件

- Python 3.8以上
- Tesseract OCR エンジン（OCR機能を使用する場合）

## インストール

詳細なインストール手順は [INSTALL.md](INSTALL.md) を参照してください。

## ライセンス

このプロジェクトは GNU General Public License v3.0 (GPL-3.0) の下でライセンスされています。

詳細なライセンス情報と依存ライブラリについては [LICENSE.md](LICENSE.md) を参照してください。

**重要**: このプロジェクトはPyMuPDF（AGPL-3.0ライセンス）を使用しています。商用利用の際はご注意ください。

## Macについて

Macでの動作確認ができていないので、特に画像の解析処理について期待通りの動作をしない可能性があります。

## 免責事項

このソフトウェアは「現状のまま」提供され、いかなる種類の保証もありません。詳細はLICENSEファイルをご確認ください。

このコードを改造有無問わず、使用した結果何らかの損害が生じても、当方含め誰も責任を負いません。
何が起きても自己解決できるよ！という方だけお使いください。

## 謝辞
Claude最高です。GeminiもChatGPTも大好きだZE★
